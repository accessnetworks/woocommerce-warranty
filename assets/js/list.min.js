jQuery(document).ready((function(e){var t;jQuery(".update-status").click((function(){var t=jQuery(this).data("request_id"),a=jQuery("#status_"+t).val();if(a){var r={action:"warranty_update_request_fragment",type:"change_status",status:a,request_id:t};e.ajax({type:"POST",url:ajaxurl,data:r,success:function(e){e&&(window.location.href=e)}})}})),jQuery("a.inline-edit").click((function(e){e.preventDefault();var t=jQuery(this).data("request_id"),a=jQuery(this).closest("tr"),r=jQuery("#inline-edit-"+t).clone();jQuery("#the-list tr#inline-edit-"+t).find(".close_tr").click(),r.insertAfter(a).show(),jQuery("<tr class='hidden'></tr>").insertBefore(r),jQuery("#the-list .tip").tipTip({maxWidth:"400px"})})),jQuery("#the-list").on("click",".close-form",(function(e){e.preventDefault(),jQuery(this).parents("div.closeable").hide()})),jQuery("#the-list").on("click",".close_tr",(function(){jQuery(this).parents("tr").remove(),jQuery("#the-list").find("tr.hidden").remove()})),jQuery("#the-list").on("click",".rma-update",(function(){var t=jQuery("#the-list"),a=t.find("input,select,textarea"),r=jQuery(a).serializeArray();r.push({name:"action",value:"warranty_update_inline"}),r.push({name:"id",value:jQuery(this).data("id")}),r.push({name:"_wpnonce",value:jQuery(this).data("security")}),t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.post(ajaxurl,r,(function(e){if("OK"==e.status){var a=jQuery(t).find(".warranty-update-message");a.find("p").html(e.message),a.show()}else alert(e.message);t.unblock()}))})),jQuery("#the-list").on("click",".rma-upload-button",(function(e){e.preventDefault();var a=jQuery(this);(t=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1})).on("select",(function(){attachment=t.state().get("selection").first().toJSON();var e=a.data("id");jQuery("#shipping_label_"+e).val(attachment.url),jQuery("#shipping_label_id_"+e).val(attachment.id)})),t.open()})),jQuery("#the-list").on("click","input.request-tracking",(function(){var t=jQuery(this).closest("tr"),a=jQuery(t).find("td");jQuery(a).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.post(ajaxurl,{action:"warranty_request_tracking",id:jQuery(this).data("request")},(function(e){jQuery(".wc-tracking-requested").show(),jQuery("#the-list .request-tracking-div").remove(),jQuery(a).unblock()}))})),jQuery("#the-list").on("click",".set-tracking",(function(){var t=jQuery(this).closest("tr"),a=jQuery(t).find("td");jQuery(a).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r="";jQuery("#the-list select.return_tracking_provider").length>0&&(r=jQuery("#the-list select.return_tracking_provider option:selected").val()),e.post(ajaxurl,{action:"warranty_set_tracking",tracking:jQuery("#the-list").find(".tracking_code").val(),id:jQuery(this).data("request"),provider:r},(function(e){jQuery(".wc-tracking-saved").show(),jQuery(a).unblock()}))})),jQuery("body").on("click",".warranty-process-refund",(function(){jQuery(this).data("id");var t=jQuery(this).data("security"),a=jQuery("table.toplevel_page_warranties"),r=jQuery(this).parents("#TB_window").find("input.amount").val();tb_remove(),a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.post(ajaxurl,{action:"warranty_refund_item",ajax:!0,id:jQuery(this).data("id"),amount:r,_wpnonce:t},(function(e){"OK"==e.status?window.location.reload():(alert(e.message),a.unblock())}))})),jQuery("body").on("click",".warranty-process-coupon",(function(){jQuery(this).data("id");var t=jQuery(this).data("security"),a=jQuery("table.toplevel_page_warranties"),r=jQuery(this).parents("#TB_window").find("input.amount").val();tb_remove(),a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.post(ajaxurl,{action:"warranty_send_coupon",ajax:!0,id:jQuery(this).data("id"),amount:r,_wpnonce:t},(function(e){"OK"==e.status?window.location.reload():(alert(e.message),a.unblock())}))})),jQuery("body").on("click",".add_note",(function(t){t.preventDefault();var a=jQuery(this).parents(".inline-edit-col"),r=jQuery(this).data("request"),n=a.find("ul.admin-notes"),i=jQuery("#admin_note_"+r).val();if(0!=i.length){a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var u={action:"warranty_add_note",request:r,note:i};e.post(ajaxurl,u,(function(e){jQuery(n).html(e),a.unblock()}))}})),jQuery("body").on("click",".delete_note",(function(t){t.preventDefault();var a=jQuery(this).parents(".inline-edit-col"),r=jQuery(this).data("note_id"),n=jQuery(this).data("request"),i=a.find("ul.admin-notes");a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var u={action:"warranty_delete_note",request:n,note_id:r};e.post(ajaxurl,u,(function(e){jQuery(i).html(e),a.unblock()}))})),jQuery(".tip").tipTip({maxWidth:"400px"})}));